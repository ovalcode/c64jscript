<!DOCTYPE html>
<html>
  <head>
    <title>6502 Emulator From Scratch</title>
    <script src="Memory.js"></script>
    <script src="Cpu.js"></script>
  </head>
  <body>
    <h1>6502 Emulator From Scratch</h1>
    <p>This is JavaScript Test</p>
<textarea id="registers" name="reg" rows="1" cols="60"></textarea>
<br/>
<textarea id="memory" name="mem" rows="15" cols="60"></textarea>
<br/>
<textarea id="diss" name="diss" rows="11" cols="60"></textarea>
<button onclick="step()">Step</button>
    <script language="JavaScript">

      var mymem = new memory();
      var mycpu = new cpu(mymem);

      function step() {
        mycpu.step();
        var t = document.getElementById("registers");
        t.value = mycpu.getDebugReg();
        
        var ins = document.getElementById("diss");
        ins.value = mycpu.getDecodedStr();

        var m = document.getElementById("memory");
        tempmemstr = ""
        for (i = 0; i < 160; i++) {
          if ((i % 16) == 0) {
            labelstr = "";
            labelstr = labelstr.concat("0000", i.toString(16));
            labelstr = labelstr.slice(-4);

            tempmemstr = tempmemstr.concat("\n",labelstr);
          }
          currentByte = mymem.readMem(i).toString(16);        
          currentByte = currentByte.concat("00",currentByte);
          currentByte = currentByte.slice(-2);
          tempmemstr = tempmemstr.concat(" ", currentByte);
        }
        m.value = tempmemstr;
        t.value = mycpu.getDebugReg();
        

        //alert(mycpu.getDebugReg());
      }

      /*mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();
      mycpu.step();

      alert(mymem.readMem(0x7d1));
      alert(mymem.readMem(0x7d2));
      alert(mymem.readMem(0x7d3));*/

    </script>
  </body>
</html>
